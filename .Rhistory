p1
# Visualización de la red
p1<-ggraph(g, layout = "in_circle") +
#theme_graph(background = "white",
#        base_family = "Helvetica",
#        foreground = 'steelblue',
#        fg_text_colour = 'white',
#        base_size = 11) +
geom_edge_link(aes(color = link)) +
geom_node_point(aes(size = centrality),alpha = 8) +
geom_node_text(aes(label = name), repel = T) +
# geom_edge_density(aes(fill = vinculo)) +
geom_edge_link(alpha = 0.001) +
#facet_edges(~year) +
theme(legend.text=element_text(size=13)) +
labs(caption = "1- Measure of centrality PN based on Everett & Borgatti 2014.
2- Links statistically significant (alpha = 0.01) compared to a null model obtained from FDSM.
3- Fuente de datos: ELSOC-COES 2016 - 2018.")
p1
ggraph(g, layout = "in_circle") +
#theme_graph(background = "white",
#        base_family = "Helvetica",
#        foreground = 'steelblue',
#        fg_text_colour = 'white',
#        base_size = 11) +
geom_edge_link(aes(color = link)) +
geom_node_point(aes(size = centrality),alpha = 8) +
geom_node_text(aes(label = name), repel = T) +
# geom_edge_density(aes(fill = vinculo)) +
geom_edge_link(alpha = 0.001) +
#facet_edges(~year) +
theme(legend.text=element_text(size=13)) +
labs(caption = "1- Measure of centrality PN based on Everett & Borgatti 2014.
2- Links statistically significant (alpha = 0.01) compared to a null model obtained from FDSM.
3- Fuente de datos: ELSOC-COES 2016 - 2018.")
# Visualización de la red
ggraph(g, layout = "in_circle") +
theme_graph(background = "white",
base_family = "Helvetica",
foreground = 'steelblue',
fg_text_colour = 'white',
base_size = 11) +
geom_edge_link(aes(color = link)) +
geom_node_point(aes(size = centrality),alpha = 8) +
geom_node_text(aes(label = name), repel = T) +
# geom_edge_density(aes(fill = vinculo)) +
geom_edge_link(alpha = 0.001) +
theme(legend.text=element_text(size=13)) +
labs(caption = "1- Measure of centrality PN based on Everett & Borgatti 2014.
2- Links statistically significant (alpha = 0.01) compared to a null model obtained from FDSM.
3- Fuente de datos: ELSOC-COES 2016 - 2018.")
ggraph(g, layout = "in_circle") +
theme_graph(background = "white",
base_family = "Helvetica",
foreground = 'steelblue',
fg_text_colour = 'white',
base_size = 11) +
geom_edge_link(alpha = 0.001) +
geom_node_point(aes(size = centrality), alpha = 0.8) +
geom_node_text(aes(label = name), repel = TRUE) +
theme(legend.text = element_text(size = 13)) +
labs(caption = "1- Measure of centrality PN based on Everett & Borgatti 2014.
2- Links statistically significant (alpha = 0.01) compared to a null model obtained from FDSM.
3- Fuente de datos: ELSOC-COES 2016 - 2018.")
g
# Visualización de la red
ggraph(g, layout = "in_circle") +
theme_graph(background = "white",
base_family = "Helvetica",
foreground = 'steelblue',
fg_text_colour = 'white',
base_size = 11) +
geom_edge_link(aes(color = link)) +
geom_node_point(aes(size = centrality),alpha = 8) +
geom_node_text(aes(label = name), repel = T) +
# geom_edge_density(aes(fill = vinculo)) +
geom_edge_link(alpha = 0.001) +
theme(legend.text=element_text(size=13)) +
labs(caption = "1- Measure of centrality PN based on Everett & Borgatti 2014.
2- Links statistically significant (alpha = 0.01) compared to a null model obtained from FDSM.
3- Fuente de datos: ELSOC-COES 2016 - 2018.")
# Visualización de la red
ggraph(g, layout = "in_circle") +
theme_graph(background = "white",
base_family = "Helvetica",
foreground = 'steelblue',
fg_text_colour = 'white',
base_size = 11) +
geom_edge_link(aes(color = "link")) +
geom_node_point(aes(size = centrality),alpha = 8) +
geom_node_text(aes(label = name), repel = T) +
# geom_edge_density(aes(fill = vinculo)) +
geom_edge_link(alpha = 0.001) +
theme(legend.text=element_text(size=13)) +
labs(caption = "1- Measure of centrality PN based on Everett & Borgatti 2014.
2- Links statistically significant (alpha = 0.01) compared to a null model obtained from FDSM.
3- Fuente de datos: ELSOC-COES 2016 - 2018.")
# Visualización de la red
ggraph(g, layout = "in_circle") +
theme_graph(background = "white",
base_family = "Helvetica",
foreground = 'steelblue',
fg_text_colour = 'white',
base_size = 11) +
geom_edge_link(color = "link") +
geom_node_point(aes(size = centrality),alpha = 8) +
geom_node_text(aes(label = name), repel = T) +
# geom_edge_density(aes(fill = vinculo)) +
geom_edge_link(alpha = 0.001) +
theme(legend.text=element_text(size=13)) +
labs(caption = "1- Measure of centrality PN based on Everett & Borgatti 2014.
2- Links statistically significant (alpha = 0.01) compared to a null model obtained from FDSM.
3- Fuente de datos: ELSOC-COES 2016 - 2018.")
E(g)$sign
g <- graph_from_data_frame(fdsm, directed = F)
E(g)[E(g)$sign ==  "1"]$link <- "attraction"
E(g)[E(g)$sign == "-1"]$link <- "repulsion"
E(g)$sign
g
E(g)[E(g)$link ==  "1"]$link <- "attraction"
g
E(g)[E(g)$weight ==  "1"]$link <- "attraction"
E(g)[E(g)$weight == "-1"]$link <- "repulsion"
# agregar atributos a la red
g$name <- "Red asociativa"
V(g)$id <- 1:9
## Calcular degree signed "ratio":  positive neighbors/(positive neighbors+negative neighbors)/
V(g)$centrality<-degree_signed(g, type="ratio")
g <- graph_from_data_frame(fdsm, directed = F)
E(g)[E(g)$weight ==  "1"]$link <- "attraction"
E(g)[E(g)$weight == "-1"]$link <- "repulsion"
# agregar atributos a la red
g$name <- "Red asociativa"
V(g)$id <- 1:9
## Calcular degree signed "ratio":  positive neighbors/(positive neighbors+negative neighbors)/
V(g)$centrality<-degree_signed(g, type="ratio")
## Calcular degree signed "ratio":  positive neighbors/(positive neighbors+negative neighbors)/
V(g)$centrality<-igraph::degree(g)
# Visualización de la red
ggraph(g, layout = "in_circle") +
theme_graph(background = "white",
base_family = "Helvetica",
foreground = 'steelblue',
fg_text_colour = 'white',
base_size = 11) +
geom_edge_link(aes(color = "link")) +
geom_node_point(aes(size = centrality),alpha = 8) +
geom_node_text(aes(label = name), repel = T) +
# geom_edge_density(aes(fill = vinculo)) +
geom_edge_link(alpha = 0.001) +
theme(legend.text=element_text(size=13)) +
labs(caption = "1- Measure of centrality PN based on Everett & Borgatti 2014.
2- Links statistically significant (alpha = 0.01) compared to a null model obtained from FDSM.
3- Fuente de datos: ELSOC-COES 2016 - 2018.")
E(g)$link
colores_link <- c("rojo", "verde")
# Visualización de la red
ggraph(g, layout = "in_circle") +
theme_graph(background = "white",
base_family = "Helvetica",
foreground = 'steelblue',
fg_text_colour = 'white',
base_size = 11) +
geom_edge_link(aes(color = link)) +
geom_node_point(aes(size = centrality),alpha = 8) +
geom_node_text(aes(label = name), repel = T) +
# geom_edge_density(aes(fill = vinculo)) +
geom_edge_link(alpha = 0.001) +
theme(legend.text=element_text(size=13)) +
labs(caption = "1- Measure of centrality PN based on Everett & Borgatti 2014.
2- Links statistically significant (alpha = 0.01) compared to a null model obtained from FDSM.
3- Fuente de datos: ELSOC-COES 2016 - 2018.")
elsoc_2016<-elsoc_2016%>%
mutate_at(dplyr::vars(matches("c12")), ~ifelse(. < 2, 0, 1)) %>% # se reduce  una línea.
dplyr::mutate (c02         = case_when(c02 == 1 ~ 1,
c02 == 2 ~ 0,
c02 == 3 ~ 1)) %>%
dplyr::mutate (mujer        = case_when(m0_sexo   == 1     ~ "hombre",
m0_sexo   == 2     ~ "mujer")) %>%
dplyr::mutate (edad         = case_when(m0_edad %in% 18:29 ~ "joven",
m0_edad %in% 30:65 ~ "adulto",
m0_edad %in% 66:88 ~ "adulto_mayor")) %>%
dplyr::mutate (nivel_educ   = case_when(m01     %in% 1 :7  ~ "no_univers",
m01     %in% 8 :10 ~ "univers"))%>%
dplyr::select(JJVV=c12_01, Religiosa=c12_02, AAEE=c12_03, Deportiva=c12_04,
Partido=c12_05, Profesional=c12_06, Sindicato=c12_07, Caridad=c12_08,
Otras=c12_09, mujer,edad,nivel_educ)
pacman::p_load(intergraph,
tidygraph,
igraph,
network,
signnet,
sna,
MASS,
ggplot2,
xlsx,
ggraph,
backbone,
dplyr,
readr,
reshape2,
extrafont,
kableExtra,
table1,
flextable,
tigerstats,
foreign,
xtable,
Hmisc,
memisc,
nnet,
lattice,
texreg
)
library(expss)
pacman::p_load(intergraph,
tidygraph,
igraph,
network,
signnet,
sna,
MASS,
ggplot2,
xlsx,
ggraph,
backbone,
dplyr,
readr,
reshape2,
extrafont,
kableExtra,
table1,
flextable,
tigerstats,
foreign,
xtable,
Hmisc,
memisc,
nnet,
lattice,
texreg,
httr
)
#ELSOC 2016
url <- "https://github.com/rcantillan/ricantillan.rbind.io/raw/main/dat/ELSOC/ELSOC_W01_v4.01_R.RData"
response <- GET(url)
local_path <- "ELSOC_W01_v4.01_R.RData"
writeBin(response$content, local_path)
load("ELSOC_W01_v4.01_R.RData")
pacman::p_load(intergraph,
tidyr,
tidygraph,
igraph,
network,
signnet,
sna,
MASS,
ggplot2,
xlsx,
ggraph,
backbone,
dplyr,
readr,
reshape2,
extrafont,
kableExtra,
table1,
flextable,
tigerstats,
foreign,
xtable,
Hmisc,
memisc,
nnet,
lattice,
texreg,
httr
)
sexolab<-c("hombre","mujer")
ego2017$sexo_h<-factor(Recode(ego2017$sexo,"1=1;2=2;-888=NA;-999=NA"),labels=sexolab)
ego2017$alterSexo1<-factor(Recode(ego2017$sexoalter01,"1=1;2=2;-888=NA;-999=NA"),labels=sexolab)
ego2017$alterSexo2<-factor(Recode(ego2017$sexoalter02,"1=1;2=2;-888=NA;-999=NA"),labels=sexolab)
ego2017$alterSexo3<-factor(Recode(ego2017$sexoalter03,"1=1;2=2;-888=NA;-999=NA"),labels=sexolab)
ego2017$alterSexo4<-factor(Recode(ego2017$sexoalter04,"1=1;2=2;-888=NA;-999=NA"),labels=sexolab)
ego2017$alterSexo5<-factor(Recode(ego2017$sexoalter05,"1=1;2=2;-888=NA;-999=NA"),labels=sexolab)
with(ego2017, summary(cbind(alterSexo1,alterSexo2,alterSexo3,alterSexo4,alterSexo5)))
asociaciones<-elsoc_2016%>%select(JJVV, Religiosa, AAEE, Deportiva, Partido, Profesional,
Sindicato, Caridad, Otras)
elsoc_2016
#elsoc_2016 <- elsoc_2016 %>%
#  dplyr::mutate (JJVV         = ifelse(c12_01>=2, 1, 0)) %>%
#  dplyr::mutate (Religiosa    = ifelse(c12_02>=2, 1, 0)) %>%
#  dplyr::mutate (Partido      = ifelse(c12_03>=2, 1, 0)) %>%
#  dplyr::mutate (Deportiva    = ifelse(c12_07>=2, 1, 0)) %>%
#  dplyr::mutate (AAEE         = ifelse(c12_08>=2, 1, 0)) %>%
#  dplyr::mutate (Caridad      = ifelse(c12_06>=2, 1, 0)) %>%
#  dplyr::mutate (Sindicato    = ifelse(c12_04>=2, 1, 0)) %>%
#  dplyr::mutate (Profesional  = ifelse(c12_05>=2, 1, 0)) %>%
#  dplyr::mutate (Otras        = ifelse(c12_09>=2, 1, 0))%>%
#  dplyr::select (JJVV, Religiosa, AAEE, Deportiva, Partido,
#                 Profesional, Sindicato, Caridad, Otras)
elsoc_2016<-elsoc_2016%>%
mutate_at(vars(matches("c12")), ~ifelse(. < 2, 0, 1)) %>% # se reduce  una línea.
dplyr::mutate (c02         = case_when(c02 == 1 ~ 1,
c02 == 2 ~ 0,
c02 == 3 ~ 1)) %>%
dplyr::mutate (mujer        = case_when(m0_sexo   == 1     ~ "hombre",
m0_sexo   == 2     ~ "mujer")) %>%
dplyr::mutate (edad         = case_when(m0_edad %in% 18:29 ~ "joven",
m0_edad %in% 30:65 ~ "adulto",
m0_edad %in% 66:88 ~ "adulto_mayor")) %>%
dplyr::mutate (nivel_educ   = case_when(m01     %in% 1 :7  ~ "no_univers",
m01     %in% 8 :10 ~ "univers"))%>%
dplyr::select(JJVV=c12_01, Religiosa=c12_02, AAEE=c12_03, Deportiva=c12_04,
Partido=c12_05, Profesional=c12_06, Sindicato=c12_07, Caridad=c12_08,
Otras=c12_09, mujer,edad,nivel_educ)
elsoc_2016<-elsoc_2016%>%
mutate_at(vars(starts_with("c12")), ~ifelse(. < 2, 0, 1)) %>% # se reduce  una línea.
dplyr::mutate (c02         = case_when(c02 == 1 ~ 1,
c02 == 2 ~ 0,
c02 == 3 ~ 1)) %>%
dplyr::mutate (mujer        = case_when(m0_sexo   == 1     ~ "hombre",
m0_sexo   == 2     ~ "mujer")) %>%
dplyr::mutate (edad         = case_when(m0_edad %in% 18:29 ~ "joven",
m0_edad %in% 30:65 ~ "adulto",
m0_edad %in% 66:88 ~ "adulto_mayor")) %>%
dplyr::mutate (nivel_educ   = case_when(m01     %in% 1 :7  ~ "no_univers",
m01     %in% 8 :10 ~ "univers"))%>%
dplyr::select(JJVV=c12_01, Religiosa=c12_02, AAEE=c12_03, Deportiva=c12_04,
Partido=c12_05, Profesional=c12_06, Sindicato=c12_07, Caridad=c12_08,
Otras=c12_09, mujer,edad,nivel_educ)
matches
elsoc_2016<-elsoc_2016%>%
mutate_at(vars(matches("c12")), ~ifelse(. < 2, 0, 1)) %>% # se reduce  una línea.
dplyr::mutate (c02         = case_when(c02 == 1 ~ 1,
c02 == 2 ~ 0,
c02 == 3 ~ 1)) %>%
dplyr::mutate (mujer        = case_when(m0_sexo   == 1     ~ "hombre",
m0_sexo   == 2     ~ "mujer")) %>%
dplyr::mutate (edad         = case_when(m0_edad %in% 18:29 ~ "joven",
m0_edad %in% 30:65 ~ "adulto",
m0_edad %in% 66:88 ~ "adulto_mayor")) %>%
dplyr::mutate (nivel_educ   = case_when(m01     %in% 1 :7  ~ "no_univers",
m01     %in% 8 :10 ~ "univers"))%>%
dplyr::select(JJVV=c12_01, Religiosa=c12_02, AAEE=c12_03, Deportiva=c12_04,
Partido=c12_05, Profesional=c12_06, Sindicato=c12_07, Caridad=c12_08,
Otras=c12_09, mujer,edad,nivel_educ)
unload(expss)
unload(expss)
unloadNamespace("expss")
#ELSOC 2016
url <- "https://github.com/rcantillan/ricantillan.rbind.io/raw/main/dat/ELSOC/ELSOC_W01_v4.01_R.RData"
response <- GET(url)
local_path <- "ELSOC_W01_v4.01_R.RData"
writeBin(response$content, local_path)
load("ELSOC_W01_v4.01_R.RData")
#elsoc_2016 <- elsoc_2016 %>%
#  dplyr::mutate (JJVV         = ifelse(c12_01>=2, 1, 0)) %>%
#  dplyr::mutate (Religiosa    = ifelse(c12_02>=2, 1, 0)) %>%
#  dplyr::mutate (Partido      = ifelse(c12_03>=2, 1, 0)) %>%
#  dplyr::mutate (Deportiva    = ifelse(c12_07>=2, 1, 0)) %>%
#  dplyr::mutate (AAEE         = ifelse(c12_08>=2, 1, 0)) %>%
#  dplyr::mutate (Caridad      = ifelse(c12_06>=2, 1, 0)) %>%
#  dplyr::mutate (Sindicato    = ifelse(c12_04>=2, 1, 0)) %>%
#  dplyr::mutate (Profesional  = ifelse(c12_05>=2, 1, 0)) %>%
#  dplyr::mutate (Otras        = ifelse(c12_09>=2, 1, 0))%>%
#  dplyr::select (JJVV, Religiosa, AAEE, Deportiva, Partido,
#                 Profesional, Sindicato, Caridad, Otras)
elsoc_2016<-elsoc_2016%>%
mutate_at(vars(matches("c12")), ~ifelse(. < 2, 0, 1)) %>% # se reduce  una línea.
dplyr::mutate (c02         = case_when(c02 == 1 ~ 1,
c02 == 2 ~ 0,
c02 == 3 ~ 1)) %>%
dplyr::mutate (mujer        = case_when(m0_sexo   == 1     ~ "hombre",
m0_sexo   == 2     ~ "mujer")) %>%
dplyr::mutate (edad         = case_when(m0_edad %in% 18:29 ~ "joven",
m0_edad %in% 30:65 ~ "adulto",
m0_edad %in% 66:88 ~ "adulto_mayor")) %>%
dplyr::mutate (nivel_educ   = case_when(m01     %in% 1 :7  ~ "no_univers",
m01     %in% 8 :10 ~ "univers"))%>%
dplyr::select(JJVV=c12_01, Religiosa=c12_02, AAEE=c12_03, Deportiva=c12_04,
Partido=c12_05, Profesional=c12_06, Sindicato=c12_07, Caridad=c12_08,
Otras=c12_09, mujer,edad,nivel_educ)
asociaciones<-elsoc_2016%>%select(JJVV, Religiosa, AAEE, Deportiva, Partido, Profesional,
Sindicato, Caridad, Otras)
#Transpose
asociaciones_t <-t(asociaciones)
#Proyección modo 1 (overlap)
overlap <- asociaciones_t%*%t(asociaciones_t)
overlap
pacman::p_load(intergraph,
tidyr,
tidygraph,
igraph,
network,
signnet,
sna,
ggplot2,
xlsx,
ggraph,
backbone,
dplyr,
readr,
extrafont,
kableExtra,
table1,
flextable,
tigerstats,
foreign,
xtable,
Hmisc,
memisc,
nnet,
lattice,
texreg,
httr
)
#unloadNamespace("expss")
#ELSOC 2016
url <- "https://github.com/rcantillan/ricantillan.rbind.io/raw/main/dat/ELSOC/ELSOC_W01_v4.01_R.RData"
response <- GET(url)
local_path <- "ELSOC_W01_v4.01_R.RData"
writeBin(response$content, local_path)
load("ELSOC_W01_v4.01_R.RData")
#elsoc_2016 <- elsoc_2016 %>%
#  dplyr::mutate (JJVV         = ifelse(c12_01>=2, 1, 0)) %>%
#  dplyr::mutate (Religiosa    = ifelse(c12_02>=2, 1, 0)) %>%
#  dplyr::mutate (Partido      = ifelse(c12_03>=2, 1, 0)) %>%
#  dplyr::mutate (Deportiva    = ifelse(c12_07>=2, 1, 0)) %>%
#  dplyr::mutate (AAEE         = ifelse(c12_08>=2, 1, 0)) %>%
#  dplyr::mutate (Caridad      = ifelse(c12_06>=2, 1, 0)) %>%
#  dplyr::mutate (Sindicato    = ifelse(c12_04>=2, 1, 0)) %>%
#  dplyr::mutate (Profesional  = ifelse(c12_05>=2, 1, 0)) %>%
#  dplyr::mutate (Otras        = ifelse(c12_09>=2, 1, 0))%>%
#  dplyr::select (JJVV, Religiosa, AAEE, Deportiva, Partido,
#                 Profesional, Sindicato, Caridad, Otras)
elsoc_2016<-elsoc_2016%>%
mutate_at(vars(matches("c12")), ~ifelse(. < 2, 0, 1)) %>% # se reduce  una línea.
dplyr::mutate (c02         = case_when(c02 == 1 ~ 1,
c02 == 2 ~ 0,
c02 == 3 ~ 1)) %>%
dplyr::mutate (mujer        = case_when(m0_sexo   == 1     ~ "hombre",
m0_sexo   == 2     ~ "mujer")) %>%
dplyr::mutate (edad         = case_when(m0_edad %in% 18:29 ~ "joven",
m0_edad %in% 30:65 ~ "adulto",
m0_edad %in% 66:88 ~ "adulto_mayor")) %>%
dplyr::mutate (nivel_educ   = case_when(m01     %in% 1 :7  ~ "no_univers",
m01     %in% 8 :10 ~ "univers"))%>%
dplyr::select(JJVV=c12_01, Religiosa=c12_02, AAEE=c12_03, Deportiva=c12_04,
Partido=c12_05, Profesional=c12_06, Sindicato=c12_07, Caridad=c12_08,
Otras=c12_09, mujer,edad,nivel_educ)
# set NA
elsoc_2016[elsoc_2016=="-999"] <- NA
elsoc_2016[elsoc_2016=="-888"] <- NA
# delete NA in covariable
elsoc_2016<-elsoc_2016 %>% drop_na(c("mujer", "edad", "nivel_educ"))
glimpse(elsoc_2016)
t1<-rowPerc(xtabs(~JJVV+mujer,data=elsoc_2016))
t2<-rowPerc(xtabs(~Religiosa+mujer,data=elsoc_2016))
t3<-rowPerc(xtabs(~Deportiva+mujer,data=elsoc_2016))
t4<-rowPerc(xtabs(~Caridad+mujer,data=elsoc_2016))
t5<-rowPerc(xtabs(~Partido+mujer,data=elsoc_2016))
t6<-rowPerc(xtabs(~Profesional+mujer,data=elsoc_2016))
t7<-rowPerc(xtabs(~Sindicato+mujer,data=elsoc_2016))
t8<-rowPerc(xtabs(~AAEE+mujer,data=elsoc_2016))
t9<-rowPerc(xtabs(~Otras+mujer,data=elsoc_2016))
a<-rbind(t1,t2,t3,t4,t5,t6,t7,t8,t9)
a<-as.data.frame(a)
a$part<-c(0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1)
a1<-a[a$part==1,]
a1$Tipo<-c("JJVV","Religiosa","Deportiva","Caridad","Partido","Profesional","Sindicato","AAEE","Otras")
a1<-a1%>%
dplyr::select(Tipo,hombre,mujer)
t1<-rowPerc(xtabs(~JJVV+nivel_educ,data=elsoc_2016))
t2<-rowPerc(xtabs(~Religiosa+nivel_educ,data=elsoc_2016))
t3<-rowPerc(xtabs(~Deportiva+nivel_educ,data=elsoc_2016))
t4<-rowPerc(xtabs(~Caridad+nivel_educ,data=elsoc_2016))
t5<-rowPerc(xtabs(~Partido+nivel_educ,data=elsoc_2016))
t6<-rowPerc(xtabs(~Profesional+nivel_educ,data=elsoc_2016))
t7<-rowPerc(xtabs(~Sindicato+nivel_educ,data=elsoc_2016))
t8<-rowPerc(xtabs(~AAEE+nivel_educ,data=elsoc_2016))
t9<-rowPerc(xtabs(~Otras+nivel_educ,data=elsoc_2016))
a<-rbind(t1,t2,t3,t4,t5,t6,t7,t8,t9)
a<-as.data.frame(a)
a$part<-c(0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1)
a2<-a[a$part==1,]
a2<-a2%>%
dplyr::select("no universitario"=no_univers, "universitario"=univers)
t1<-rowPerc(xtabs(~JJVV+edad,data=elsoc_2016))
t2<-rowPerc(xtabs(~Religiosa+edad,data=elsoc_2016))
t3<-rowPerc(xtabs(~Deportiva+edad,data=elsoc_2016))
t4<-rowPerc(xtabs(~Caridad+edad,data=elsoc_2016))
t5<-rowPerc(xtabs(~Partido+edad,data=elsoc_2016))
t6<-rowPerc(xtabs(~Profesional+edad,data=elsoc_2016))
t7<-rowPerc(xtabs(~Sindicato+edad,data=elsoc_2016))
t8<-rowPerc(xtabs(~AAEE+edad,data=elsoc_2016))
t9<-rowPerc(xtabs(~Otras+edad,data=elsoc_2016))
a<-rbind(t1,t2,t3,t4,t5,t6,t7,t8,t9)
a<-as.data.frame(a)
a$part<-c(0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1)
a3<-a[a$part==1,]
a3<-a3%>%
dplyr::select(joven, adulto, "adulto mayor"=adulto_mayor)
tabla1<-cbind(a1,a2,a3)
tabla1<-as.data.frame(tabla1)
tabla1<-tibble::rowid_to_column(tabla1, "id")
tabla1 %>%
kbl(caption = "Composición (%) de participantes en asociaciones voluntarias (ELSOC 2016)") %>%
kable_classic("hover", full_width = F)
asociaciones<-elsoc_2016%>%select(JJVV, Religiosa, AAEE, Deportiva, Partido, Profesional,
Sindicato, Caridad, Otras)
fdsm  <- fdsm(asociaciones_t, trials = 10000, alpha = 0.01, signed=TRUE, class="edgelist")
