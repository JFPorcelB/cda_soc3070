"0","# Cargar las librerías necesarias"
"0","library(lubridate)  # Para manejo de fechas"
"0",""
"0","# Preparación de datos"
"0","# Asumimos que 'data' ya está cargado y tiene las columnas: date, value, group, category"
"0",""
"0","# Agregar una columna de mes a los datos originales"
"0","data <- data %>%"
"0","  mutate(month = floor_date(date, ""month""))"
"0","  # floor_date() redondea las fechas al inicio del mes"
"0",""
"0","# Calcular promedios mensuales"
"0","monthly_data <- data %>%"
"0","  group_by(month, group, category) %>%"
"0","  # Agrupar por mes, grupo y categoría"
"0","  summarise(avg_value = mean(value, na.rm = TRUE), .groups = 'drop')"
"0","  # Calcular el promedio de 'value', ignorando NA"
"0","  # .groups = 'drop' elimina la agrupación después de summarise"
"0",""
"0","# Crear el gráfico mejorado"
"0","ggplot(monthly_data, aes(x = month, y = avg_value, color = group)) +"
"0","  # Definir los datos y mapeos estéticos básicos"
"0","  geom_line(size = 1) +"
"0","  # Añadir líneas para mostrar tendencias"
"0","  geom_point(size = 2) +"
"0","  # Añadir puntos para mostrar valores específicos"
"0","  facet_wrap(~category, scales = ""free_y"", nrow = 3) +"
"0","  # Crear subgráficos por categoría, permitiendo escalas y libres en y"
"0","  scale_color_brewer(palette = ""Set2"") +"
"0","  # Usar una paleta de colores predefinida de ColorBrewer"
"0","  scale_x_date(date_breaks = ""2 months"", date_labels = ""%b %Y"") +"
"0","  # Formatear el eje x para mostrar fechas cada 2 meses"
"0","  labs(title = ""Tendencia de valores promedio mensuales por grupo y categoría"","
"0","       x = ""Mes"", "
"0","       y = ""Valor promedio"","
"0","       color = ""Grupo"") +"
"0","  # Añadir títulos y etiquetas"
"0","  theme_minimal() +"
"0","  # Usar un tema minimalista como base"
"0","  theme("
"0","    legend.position = ""bottom"","
"0","    # Colocar la leyenda en la parte inferior"
"0","    axis.text.x = element_text(angle = 45, hjust = 1),"
"0","    # Rotar las etiquetas del eje x para mejor lectura"
"0","    panel.grid.minor = element_blank(),"
"0","    # Eliminar las líneas de cuadrícula menores"
"0","    strip.background = element_rect(fill = ""lightgray"", color = NA),"
"0","    # Personalizar el fondo de las etiquetas de facetas"
"0","    strip.text = element_text(face = ""bold"", size = 10)"
"0","    # Personalizar el texto de las etiquetas de facetas"
"0","  )"
